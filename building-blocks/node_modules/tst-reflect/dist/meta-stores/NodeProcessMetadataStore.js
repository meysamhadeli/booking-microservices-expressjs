"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.NodeProcessMetadataStore = void 0;
const consts_1 = require("../consts");
const Type_1 = require("../Type");
const MetadataStoreBase_1 = require("./MetadataStoreBase");
class NodeProcessMetadataStore extends MetadataStoreBase_1.MetadataStoreBase {
    constructor() {
        super(...arguments);
        this._store = {};
    }
    static initiate() {
        if (!process) {
            throw new Error("This environment does not support the nodejs process store. Are you running this from a browser?");
        }
        if (process[consts_1.REFLECT_STORE_SYMBOL]) {
            return process[consts_1.REFLECT_STORE_SYMBOL];
        }
        process[consts_1.REFLECT_STORE_SYMBOL] = new NodeProcessMetadataStore();
        Type_1.Type._setStore(process[consts_1.REFLECT_STORE_SYMBOL]);
        return process[consts_1.REFLECT_STORE_SYMBOL];
    }
    static get() {
        return process[consts_1.REFLECT_STORE_SYMBOL] || this.initiate();
    }
    get store() {
        return this._store;
    }
    get(id) {
        var _a;
        return (_a = this._store[id]) !== null && _a !== void 0 ? _a : undefined;
    }
    getLazy(id) {
        return function lazyType() {
            var _a;
            return (_a = process[consts_1.REFLECT_STORE_SYMBOL].get(id)) !== null && _a !== void 0 ? _a : undefined;
        };
    }
}
exports.NodeProcessMetadataStore = NodeProcessMetadataStore;
